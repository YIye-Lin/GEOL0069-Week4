# Unsupervised Learning for Sea Ice and Lead Classification
## Background

### What is Unsupervised Learning?

**Unsupervised learning** is a branch of machine learning that seeks to discover hidden patterns or groupings in data without pre-labeled examples. Unlike supervised learning, which uses labeled training data (e.g., “ice” vs. “lead” examples), unsupervised techniques rely purely on the intrinsic properties of the dataset (distances, statistical distributions, and so forth) to form clusters.

### K-Means vs. Gaussian Mixture Models (GMM)

-   **K-Means Clustering**:
    
    -   Partitions data points into a fixed number of clusters (kkk).
    -   Each cluster is defined by a centroid, and every data point is assigned to the nearest centroid.
    -   Results in **hard clustering**: each item is strictly in one cluster.
-   **Gaussian Mixture Models (GMM)**:
    
    -   Assumes data is generated by a mixture of several Gaussian distributions, each corresponding to a cluster.
    -   Provides **soft clustering**: each data point is assigned a probability of belonging to each Gaussian (i.e., each cluster).
    -   More flexible in capturing cluster shapes (ellipsoidal, etc.) and typically converges via the Expectation-Maximization algorithm.

### Why Classify Sea Ice vs. Leads?

Accurate classification of **sea ice** and **leads** (open-water channels) in remote sensing data is vital for studying polar dynamics, monitoring climate change, and informing navigation in ice-covered waters. Optical imagery (like **Sentinel-2**) can often distinguish ice from water via brightness differences. Altimetry data (like **Sentinel-3**), when analyzed with derived waveforms and statistics, can also separate echo signatures between ice and open leads.

----------

## Data Requirements

1.  **Sentinel-2 Optical Data**
    
    -   Typically uses bands in format (e.g., Band 2, Band 3, Band 4).
    -   The relevant spectral bands can highlight differences in reflectance between snow/ice and open water.
2.  **Sentinel-3 Altimetry Data**
    
    -   Distributed in NetCDF () files that may contain waveforms, stack data, backscatter measurements, latitude/longitude, and standard ESA classification flags indicating ice or water.
    -   Focus is on the _enhanced measurement_ dataset, which provides full waveforms and additional parameters.

----------

## Approach Overview

At a high level, the project is divided into two parallel paths:

1.  **Sentinel-2**:
    
    -   Read and stack spectral bands.
    -   Apply K-Means or GMM to cluster pixels.
    -   Output a labeled image showing which pixels likely correspond to sea ice vs. leads.
2.  **Sentinel-3**:
    
    -   Read altimetry waveforms and associated parameters.
    -   Derive specialized features (peakiness, stack standard deviation, and backscatter).
    -   Use GMM to cluster waveforms into two classes (ice vs. leads).
    -   Compare results to official ESA flags to evaluate accuracy.

----------

## Detailed Steps

### 1. Setting Up the Environment

-   **Install Python 3** and libraries for numerical computing and data visualization (NumPy, SciPy, Matplotlib, scikit-learn).
-   **Install Rasterio** (to read Sentinel-2 files).
-   **Install netCDF4** (to handle Sentinel-3 files).

Ensure your environment is properly configured so you can read large image files (for Sentinel-2) and handle multiple variables (for Sentinel-3).

### 2. Preprocessing Sentinel-2 Data

1.  **Organize the band images**:  
    Place the relevant files in a dedicated folder. Each file corresponds to one spectral band, such as Band 2, Band 3, Band 4.
    
2.  **Load and stack bands**:
    
    -   Each image band has the same spatial dimensions (rows and columns).
    -   Read each band into memory and combine them into a multi-dimensional array (e.g., stacking along a third dimension for multiple bands).
3.  **Apply data masks**:
    
    -   Identify invalid pixels or areas with no data (often zeros or special “nodata” values).
    -   Either discard these areas or mark them for exclusion from clustering.
4.  **Reshape/prepare for clustering**:
    
    -   Flatten the multi-band image so each row in your data array corresponds to one pixel’s band values.
    -   (Optional) Standardize or normalize the band values so no single band dominates the clustering.

### 3. Running K-Means or GMM on Sentinel-2 Imagery

1.  **Determine the number of clusters**:
    
    -   In sea ice vs. lead discrimination, you typically use 2 clusters.
    -   If you suspect more sub-classes of ice or water, you can test more clusters.
2.  **Perform clustering**:
    
    -   **K-Means**: Iteratively assign each pixel to the nearest centroid, then update the centroids until stable.
    -   **GMM**: Use the Expectation-Maximization algorithm to fit a mixture of Gaussians and estimate the probability of each pixel belonging to each cluster.
3.  **Assign cluster labels**:
    
    -   If 2 clusters are requested, the result is typically labeled as “0” or “1.”
    -   A quick visual check (e.g., overlay cluster labels on the image) can help you decide which label is ice vs. lead.
4.  **Visualize or export**:
    
    -   Reshape the 1D cluster label array back into the original image dimensions.
    -   Display or save this labeled image to assess how well the clustering separated ice from open water.

### 4. Preprocessing Sentinel-3 Altimetry Data

1.  **Open NetCDF file**:  
    Use a specialized library that can read variables stored in the enhanced measurement file. You should see time, latitude, longitude, waveforms, and possibly ESA classification flags (1 for ice, 2 for leads).
    
2.  **Filter out invalid data**:
    
    -   Rows with missing lat/lon or obviously erroneous values must be removed.
    -   Some datasets come with flags or fill values for missing data.
3.  **Split or index your data**:
    
    -   Make sure you isolate just the Ku-band waveforms if the file also contains C-band or other variables.
    -   Align the sampling frequencies if some variables are at 1 Hz and others at 20 Hz (often done via interpolation).

### 5. Computing Altimetry Features

1.  **Peakiness (PP)**:
    
    -   Measures how “peaked” each waveform is by comparing the maximum amplitude to the average or total power above a noise floor.
    -   A high peakiness often indicates a sharper echo (commonly associated with leads).
2.  **Stack Standard Deviation (SSD)**:
    
    -   Quantifies the spread of the stacked echoes. In some approaches, a Gaussian function is fit to the rip/stack waveform to estimate its width.
    -   Sea ice echoes may have different shapes compared to open leads.
3.  **Backscatter (sig_0)**:
    
    -   Represents the normalized returned power from the surface.
    -   Different surfaces (ice vs. water) often have distinguishable backscatter signatures.
4.  **Assemble features**:  
    Combine peakiness, SSD, and backscatter into a single feature vector for each echo. Consider standardizing these features so they’re on similar scales.
    

### 6. Clustering Sentinel-3 Data

1.  **Select the model**:
    
    -   Typically, a **GMM** with 2 components is used for sea ice vs. lead classification.
    -   You could also try K-Means, though GMM often captures subtle differences in echo shapes more effectively.
2.  **Fit the model**:
    
    -   The algorithm will estimate cluster means (if K-Means) or Gaussian parameters (if GMM).
    -   The altimetry echoes are then assigned to one cluster or another (in GMM’s case, they receive probabilities for each cluster).
3.  **Assign cluster labels**:
    
    -   Similar to Sentinel-2, the output is typically labeled “0” or “1.”
    -   You then interpret which cluster aligns with ice and which with leads by checking sample waveforms or known flags.

### 7. Validating Sentinel-3 Results

1.  **Compare to ESA official flags**:
    
    -   If the NetCDF includes a “surface type” or “class” variable (e.g., 1 for ice, 2 for leads), subtract 1 from that to convert it to 0/1.
    -   Compare with the GMM’s cluster assignments.
2.  **Generate metrics**:
    
    -   Create a **confusion matrix** to see how many ice-labeled echoes your cluster recognized correctly and how many leads were identified accurately.
    -   Compute **precision, recall, F1-score**, or overall accuracy to see the performance.
3.  **Inspect waveforms**:
    
    -   Plot mean waveforms per cluster to confirm that the shapes match your expectations for sea ice or leads.
    -   Check a few individual waveforms from each cluster for a more tangible look at the classification decisions.
